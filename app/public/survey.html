<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Friend Finder | Survey</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.1/css/bulma.min.css">
    <link rel="stylesheet" type="text/css" media="screen" href="./styles/style.css" />

</head>
<body>
    <section class="hero is-primary is-medium" id="hero-survey">
        <div class="hero-body">
            <div class="container has-text-centered">
                <h1 class="title">
                    Friend Finder Survey
                </h1>
                <h2 class="subtitle">
                    Take this short survey to find a friend!
                </h2>
            </div>
        </div>
    </section>

    <section class="section">
        <div class="columns">
            <div class="column is-half is-offset-one-quarter">
                <div class="field">
                    <label class="label" for="name">Name: </label>
                    <div class="control">
                        <input class="input" type="text" id="name" placeholder="John Smith">
                    </div>
                </div>

                <div class="field">
                    <label class="label" for="img">Profile Image: </label>
                    <div class="control">
                        <input class="input" type="text" id="img" placeholder="Image URL">
                    </div>
                </div>
                
                <br><br>

                    <div class="container">

                        <div class="field">
                            <p>1. Your mind is always buzzing with unexplored ideas and plans.</p>
                            <br>
                            <div class="field-body">
                                <div class="control question">
                                    <label class="radio">
                                        <input type="radio" name="q0" value="1">
                                        1
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q0" value="2">
                                        2
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q0" value="3">
                                        3
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q0" value="4">
                                        4
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q0" value="5">
                                        5
                                    </label>
                                </div>
                            </div>
                        </div>
    
                        <br><br>
                        
                        <div class="field">
                            <p>2. Generally speaking, you rely more on your experience than your imagination.</p>
                            <br>
                            <div class="field-body">
                                <div class="control question">
                                    <label class="radio">
                                        <input type="radio" name="q1" value="1">
                                        1
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q1" value="2">
                                        2
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q1" value="3">
                                        3
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q1" value="4">
                                        4
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q1" value="5">
                                        5
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <br><br>
    
                        <div class="field">
                            <p>3. You find it easy to stay relaxed and focused even when there is some pressure.</p>
                            <br>
                            <div class="field-body">
                                <div class="control question">
                                    <label class="radio">
                                        <input type="radio" name="q2" value="1">
                                        1
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q2" value="2">
                                        2
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q2" value="3">
                                        3
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q2" value="4">
                                        4
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q2" value="5">
                                        5
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <br><br>
    
                        <div class="field">
                            <p>4. You rarely do something just out of sheer curiosity.</p>
                            <br>
                            <div class="field-body">
                                <div class="control question">
                                    <label class="radio">
                                        <input type="radio" name="q3" value="1">
                                        1
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q3" value="2">
                                        2
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q3" value="3">
                                        3
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q3" value="4">
                                        4
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q3" value="5">
                                        5
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <br><br>

                        <div class="field">
                            <p>5. People can rarely upset you.</p>
                            <br>
                            <div class="field-body">
                                <div class="control question">
                                    <label class="radio">
                                        <input type="radio" name="q4" value="1">
                                        1
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q4" value="2">
                                        2
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q4" value="3">
                                        3
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q4" value="4">
                                        4
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q4" value="5">
                                        5
                                    </label>
                                </div>
                            </div>
                        </div>
                            
                        <br><br>
                        
                        <div class="field">
                            <p>6. It is often difficult for you to relate to other peopleâ€™s feelings.</p>
                            <br>
                            <div class="field-body">
                                <div class="control question">
                                    <label class="radio">
                                        <input type="radio" name="q5" value="1">
                                        1
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q5" value="2">
                                        2
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q5" value="3">
                                        3
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q5" value="4">
                                        4
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q5" value="5">
                                        5
                                    </label>
                                </div>
                            </div>
                        </div>
                                
                        <br><br>

                        <div class="field">
                            <p>7. You rarely get carried away by fantasies and ideas.</p>
                            <br>
                            <div class="field-body">
                                <div class="control question">
                                    <label class="radio">
                                        <input type="radio" name="q6" value="1">
                                        1
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q6" value="2">
                                        2
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q6" value="3">
                                        3
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q6" value="4">
                                        4
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q6" value="5">
                                        5
                                    </label>
                                </div>
                            </div>
                        </div>
                                
                        <br><br>

                        <div class="field">
                            <p>8. You think that everyoneâ€™s views should be respected regardless of whether they are supported by facts or not.</p>
                            <br>
                            <div class="field-body">
                                <div class="control question">
                                    <label class="radio">
                                        <input type="radio" name="q7" value="1">
                                        1
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q7" value="2">
                                        2
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q7" value="3">
                                        3
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q7" value="4">
                                        4
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q7" value="5">
                                        5
                                    </label>
                                </div>
                            </div>
                        </div>
                                
                        <br><br>

                        <div class="field">
                            <p>9. You feel more energetic after spending time with a group of people.</p>
                            <br>
                            <div class="field-body">
                                <div class="control question">
                                    <label class="radio">
                                        <input type="radio" name="q8" value="1">
                                        1
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q8" value="2">
                                        2
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q8" value="3">
                                        3
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q8" value="4">
                                        4
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q8" value="5">
                                        5
                                    </label>
                                </div>
                            </div>
                        </div>
                                
                        <br><br>

                        <div class="field">
                            <p>10. People can rarely upset you.</p>
                            <br>
                            <div class="field-body">
                                <div class="control question">
                                    <label class="radio">
                                        <input type="radio" name="q9" value="1">
                                        1
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q9" value="2">
                                        2
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q9" value="3">
                                        3
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q9" value="4">
                                        4
                                    </label>
                                    <label class="radio">
                                        <input type="radio" name="q9" value="5">
                                        5
                                    </label>
                                </div>
                            </div>
                        </div>
                                
                        <br><br>
                        
                        <div class="field">
                            <div class="control">
                                <button class="button is-danger" id="find">Find a Friend!</button>
                            </div>
                        </div>
                    </div>


                </div>
            </div>
        </div>
    </section>

    <div class="modal" id="resultsModal">
        <div class="modal-background"></div>
        <div class="modal-card">
            <header class="modal-card-head">
                <h1 class="modal-card-title">Results: </h1>
            </header>
            <section class="modal-card-body">
                <div class="container" id="results">
                    <!--insert content here-->    
                </div>
            </section>
            <footer class="modal-card-foot">
                <button class="button is-danger" id="home">Back to home</button>
            </footer>
        </div>
        <button class="modal-close is-large" aria-label="close"></button>
    </div>
    
</body>

<script type="text/javascript">
    $('#find').on('click', function(event){
        event.preventDefault;
        let arr = [];
        $('.question').each(function (i, val) {
            const radioQuery = 'input[name="q' + i +'"]:checked';
            const ans = document.querySelector(radioQuery).value;
            arr.push(ans);
        });
        console.log(arr);
        const newFriend = {
            name: $('#name').val().trim(),
            profile: $('#img').val().trim(),
            scores: arr
        }
        console.log(newFriend); 

        $.ajax('/api/friends', {
            type: 'POST',
            data: newFriend
        }).then(
            function (data, status) {
                
                const el = $('<div>').addClass('container');

                data.forEach(function (match) {
                    const card = $('<div>').addClass('card');
                    const cardImg = $('<div>').addClass('card-image');
                    const figure = $('<figure>').addClass('image');
                    const image = $('<img>')
                        .attr("src", match.profile)
                        .attr("alt", match.name + "image");
                    const content = $('<div>').addClass('card-content');
                    const title = $('<h2>').addClass('title is-3').text(match.name);

                    content.append(title);
                    figure.append(image);
                    cardImg.append(figure);
                    card
                        .append(cardImg)
                        .append(content);
                    
                    el.append(card);
                
                });

                $('#results').append(el);

            });   

        $('#resultsModal').addClass('is-active');
    });

    $('#home').on('click', function(event) {
        $('#resultsModal').removeClass('is-active');
        window.location = '/';
    });

    $('.modal-close').on('click', function(event) {
        $('#resultsModal').removeClass('is-active');
        window.location = '/';
    });
</script>

</html>